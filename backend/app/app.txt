from fastapi import FastAPI
from pydantic import BaseModel
import openai
import os
from dotenv import load_dotenv

load_dotenv()
openai.api_key = os.getenv("OPENAI_API_KEY")

app = FastAPI()

class Ingredients(BaseModel):
    ingredients: list[str]

@app.post("/recipes")
def get_recipes(ing: Ingredients):
    prompt = f"Give me 3 simple recipes using: {', '.join(ing.ingredients)}"
    response = openai.Completion.create(
        model="text-davinci-003",
        prompt=prompt,
        max_tokens=150
    )
    return {"recipes": response.choices[0].text.strip()}
